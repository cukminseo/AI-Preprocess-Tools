import numpy as np
from scipy.sparse.linalg import svds

# 사용자-아이템 평점 행렬
A = np.array([
    [5, 3, 0, 1],
    [4, 0, 0, 1],
    [1, 1, 0, 5],
    [1, 0, 0, 4],
    [0, 1, 5, 4],
], dtype=float)

# SVD 수행
U, sigma, Vt = svds(A, k = 2)

# 대각 행렬로 변환
sigma = np.diag(sigma)

print(U)
"""
# Output :
[[-0.66924125 -0.43689593]
 [-0.44308727 -0.29717498]
 [ 0.13631518 -0.51589728]
 [ 0.11077382 -0.39999635]
 [ 0.5700326  -0.54282768]]
"""
print(sigma)
""" Output :
[[6.22925557 0.        ]
 [0.         9.03171974]]
 """
print(Vt)
""" Output :
[[-0.78203025 -0.20891356  0.45754472  0.36801718]
 [-0.47488998 -0.26234348 -0.3005118  -0.78444124]]
 """

# 원래 행렬을 근사
A_pred = np.dot(np.dot(U, sigma), Vt)
""" Output :
[[ 5.13406479  1.90612125 -0.72165061  1.5611261 ]
 [ 3.43308995  1.28075331 -0.45629689  1.08967559]
 [ 1.54866643  1.0449763   1.78873709  3.96755551]
 [ 1.17598269  0.80359806  1.40136891  3.08786154]
 [-0.44866693  0.5443561   3.09799526  5.15263893]]
"""

print(A_pred)
